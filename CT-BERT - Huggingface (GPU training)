{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"CT-BERT - Huggingface (GPU training)","provenance":[{"file_id":"https://github.com/digitalepidemiologylab/covid-twitter-bert/blob/master/CT_BERT_Huggingface_(GPU_training).ipynb","timestamp":1600944720616}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"a9f62d69afac4080b839a6a407dfa215":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_53c87125fb0f4ec581d67adfd3d15fb9","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_e3a171245ce94e9faf8dcb0a38873251","IPY_MODEL_5f3c9cc29cee4f28bbb36fd38ed80962"]}},"53c87125fb0f4ec581d67adfd3d15fb9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e3a171245ce94e9faf8dcb0a38873251":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_5d1dd23eeac54f408c32839da1b9683e","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":421,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":421,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7675b01d5184478b8055739853e5541d"}},"5f3c9cc29cee4f28bbb36fd38ed80962":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e9521088cdc943478bfc312258d2c87c","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 421/421 [00:02&lt;00:00, 157B/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1b7090e0e809405886f311cac86c66bd"}},"5d1dd23eeac54f408c32839da1b9683e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"7675b01d5184478b8055739853e5541d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e9521088cdc943478bfc312258d2c87c":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"1b7090e0e809405886f311cac86c66bd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d06c9290289543c3b61dec4c003459c0":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_8ee24d3b547244369ecc0bb188c4caa6","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_65406a6ef4814c41b2c200434d93b754","IPY_MODEL_b3ad124c70804452b9b6e998a0f25534"]}},"8ee24d3b547244369ecc0bb188c4caa6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"65406a6ef4814c41b2c200434d93b754":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_b4ebf1df16164843a9ecb8c49f8fd4da","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":231508,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":231508,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_1e06490637494e2c82bfc75e99f4a655"}},"b3ad124c70804452b9b6e998a0f25534":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_fe9097ca60394923a73327ba2ae69913","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 232k/232k [00:01&lt;00:00, 128kB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8b26b6f713d4446793dffe5ce6a8352a"}},"b4ebf1df16164843a9ecb8c49f8fd4da":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"1e06490637494e2c82bfc75e99f4a655":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fe9097ca60394923a73327ba2ae69913":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"8b26b6f713d4446793dffe5ce6a8352a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6b5dd48483d146f6b84387ded636d1a1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_4f23c7b159c74b6eb58632e318a457f8","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_1cf3af77ea7d477bbf6520d505d7964a","IPY_MODEL_291fea0296f142e0a88247e4d7234f1c"]}},"4f23c7b159c74b6eb58632e318a457f8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1cf3af77ea7d477bbf6520d505d7964a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_21440d6a9a2247d4a76e204065427f5a","_dom_classes":[],"description":"Dl Completed...: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f09f8e1e3e594f218474d572039e113c"}},"291fea0296f142e0a88247e4d7234f1c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_583155561188413c8c85c31b4f8f0dfb","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:00&lt;00:00,  1.14 url/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c346b17104064b02bb038a17a4a30fd2"}},"21440d6a9a2247d4a76e204065427f5a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"f09f8e1e3e594f218474d572039e113c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"583155561188413c8c85c31b4f8f0dfb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c346b17104064b02bb038a17a4a30fd2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"134df7bab1a54b8ca72df957a4969fdb":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_bddc6e27220549d789162106d467e228","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8925cfbbf6da49268eb3624dd786457c","IPY_MODEL_bad2dde9b4ae4bcd9354ccdd45fa09e7"]}},"bddc6e27220549d789162106d467e228":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8925cfbbf6da49268eb3624dd786457c":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_5cabcb9b516048648c5b82e8f4076054","_dom_classes":[],"description":"Dl Size...: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6f68a74553324ba9950952347a9d6632"}},"bad2dde9b4ae4bcd9354ccdd45fa09e7":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_ab77816ed35540e0aed5e953476973de","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 7/7 [00:00&lt;00:00,  8.25 MiB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_66040b7f0b8c4dc3be1d212e57558231"}},"5cabcb9b516048648c5b82e8f4076054":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"6f68a74553324ba9950952347a9d6632":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ab77816ed35540e0aed5e953476973de":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"66040b7f0b8c4dc3be1d212e57558231":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8bb2ae80097b4e859e6f941202021a16":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_6888bc1d4ed249d284ff7c0aeaeebe24","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_5a3d59d501f44664977bc96f943dd432","IPY_MODEL_e308e7ce897f4f14b475e7c932848a15"]}},"6888bc1d4ed249d284ff7c0aeaeebe24":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5a3d59d501f44664977bc96f943dd432":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_fd87d3d07e124b9cb321070e5581cc32","_dom_classes":[],"description":"Extraction completed...: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e530d02650d84edeb5395ed828639eb2"}},"e308e7ce897f4f14b475e7c932848a15":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_55ce2d8c89644d99936d3067719a1b67","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:00&lt;00:00,  1.22 file/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_e6f17424f81c44a39eb080ac6aaf6c0b"}},"fd87d3d07e124b9cb321070e5581cc32":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"e530d02650d84edeb5395ed828639eb2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"55ce2d8c89644d99936d3067719a1b67":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"e6f17424f81c44a39eb080ac6aaf6c0b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b4c8e28ce61c49f397ba22d401d3367f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e1a683ba136e4e91963ebe731a0d8e8c","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_6338f93da0254c14a2d9c75107ae0826","IPY_MODEL_978e793156fe4ea2b9184e2179231508"]}},"e1a683ba136e4e91963ebe731a0d8e8c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6338f93da0254c14a2d9c75107ae0826":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_8c36c7821268467abe7d3f32c3a63e47","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f7f5fc8c8d0e4ae2a0860cb65bd34e44"}},"978e793156fe4ea2b9184e2179231508":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_002c3449d9784af88ebae617322401bd","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 67349/0 [00:20&lt;00:00, 3289.50 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_7a64d6adad894d58949a82a2451b5a08"}},"8c36c7821268467abe7d3f32c3a63e47":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"f7f5fc8c8d0e4ae2a0860cb65bd34e44":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"002c3449d9784af88ebae617322401bd":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"7a64d6adad894d58949a82a2451b5a08":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8e1e88c3db8546f4976ba22a5a352b6f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_5a4005cccb094289aecd8940f7b92982","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_6991e8054c3f4956b026f21483a057dd","IPY_MODEL_897dffd6859a470fa21e0fe9c05dfede"]}},"5a4005cccb094289aecd8940f7b92982":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6991e8054c3f4956b026f21483a057dd":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_cd927323519d45528f8bbabc7bbea025","_dom_classes":[],"description":" 46%","_model_name":"FloatProgressModel","bar_style":"danger","max":67349,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":30653,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_6cfea569105d4ae08be5d561b738957a"}},"897dffd6859a470fa21e0fe9c05dfede":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_b6f1f4362b424b4e899907122ebb6605","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 30653/67349 [00:00&lt;59:14, 10.32 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_462e909ed6d24fa4b4fdb9ba31948c62"}},"cd927323519d45528f8bbabc7bbea025":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"6cfea569105d4ae08be5d561b738957a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"b6f1f4362b424b4e899907122ebb6605":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"462e909ed6d24fa4b4fdb9ba31948c62":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0d2408609b59439abfa3a45ec762d981":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_c82597d869d246a683cfba632ca84190","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8ca7442e125c4662933cf169c96447f8","IPY_MODEL_2e03efa720ed4ec7bd6ec710ea1854be"]}},"c82597d869d246a683cfba632ca84190":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8ca7442e125c4662933cf169c96447f8":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_44c633f9229f48f283fb2145a100a5d9","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_762bf18427954f9a9a6b447bb01b151d"}},"2e03efa720ed4ec7bd6ec710ea1854be":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_894b0fff28b742189c8ea6906e8ce857","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 872/0 [00:00&lt;00:00, 2474.54 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ed9da6d94fe342b9b56903d73bf47844"}},"44c633f9229f48f283fb2145a100a5d9":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"762bf18427954f9a9a6b447bb01b151d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"894b0fff28b742189c8ea6906e8ce857":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"ed9da6d94fe342b9b56903d73bf47844":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1c2a1f72361c407d89c3310e5b995f29":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_7116cbc123a944eabd974044fb65524f","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8ba5ba2b586847589845cee62a06e233","IPY_MODEL_97875d64ee5d4f6f971d17516bf27aa8"]}},"7116cbc123a944eabd974044fb65524f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8ba5ba2b586847589845cee62a06e233":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_d45ebbf8c5f84d66bdd39af9390092a5","_dom_classes":[],"description":"  0%","_model_name":"FloatProgressModel","bar_style":"danger","max":872,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":0,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_366448a3f8cf40f794705ffa80cb24ec"}},"97875d64ee5d4f6f971d17516bf27aa8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_30b09c9f17e4485f9453fec50be827ea","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 0/872 [00:00&lt;?, ? examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8a9f5e4fbc1947d8a7017e4b98e9eefa"}},"d45ebbf8c5f84d66bdd39af9390092a5":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"366448a3f8cf40f794705ffa80cb24ec":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"30b09c9f17e4485f9453fec50be827ea":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"8a9f5e4fbc1947d8a7017e4b98e9eefa":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"323a661cbdd54394a7ca629240a5879e":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_565daf2757a84ddfba99ba2d22d67701","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8c28a2c70a79477b84d05b4af8ce1678","IPY_MODEL_c7bddcb5383145d8af92f9d3f39b9d02"]}},"565daf2757a84ddfba99ba2d22d67701":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8c28a2c70a79477b84d05b4af8ce1678":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_ca973546fc2242e8acc22e721df0e837","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3037a765ecf94c54adae0f0ea3910810"}},"c7bddcb5383145d8af92f9d3f39b9d02":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_eebc3cba722c4dac8ef1b72682d04522","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1821/0 [00:00&lt;00:00, 2826.81 examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_fcf15b8a10e9464899c3daafe9cb7174"}},"ca973546fc2242e8acc22e721df0e837":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"3037a765ecf94c54adae0f0ea3910810":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"eebc3cba722c4dac8ef1b72682d04522":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"fcf15b8a10e9464899c3daafe9cb7174":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3d816b28359e48a6b429f5a91e50109d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_96e2061317034719b31fb4e474e49233","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_fc030b73ced7487b831064fe2d030ea9","IPY_MODEL_da727efa21c04bd9aadb64e5212de8c4"]}},"96e2061317034719b31fb4e474e49233":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fc030b73ced7487b831064fe2d030ea9":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_5e8c00e558594d87a295655d77d882a3","_dom_classes":[],"description":"  0%","_model_name":"FloatProgressModel","bar_style":"danger","max":1821,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":0,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ad44a023ca1c4b1cb31a70551ab9926f"}},"da727efa21c04bd9aadb64e5212de8c4":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_25b53a4457e241f899c67dd3cc27767f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 0/1821 [00:00&lt;?, ? examples/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_f016305661d94573b22509bd44c299f9"}},"5e8c00e558594d87a295655d77d882a3":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ad44a023ca1c4b1cb31a70551ab9926f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"25b53a4457e241f899c67dd3cc27767f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"f016305661d94573b22509bd44c299f9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"448f914b46b644f5851f1af379b6a4e1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_0b613b02dfe34bb682b4964c15808aff","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_fe8a58e6570b47368d8af58c9f88252d","IPY_MODEL_def365577baa4c06964afa044aeaf6c2"]}},"0b613b02dfe34bb682b4964c15808aff":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"fe8a58e6570b47368d8af58c9f88252d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_f0265fb7ba1b45f6a9f9187918bf549c","_dom_classes":[],"description":"Downloading: 100%","_model_name":"FloatProgressModel","bar_style":"success","max":1472566816,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1472566816,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d299f05a0190420cbee345284d7018a0"}},"def365577baa4c06964afa044aeaf6c2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_3554e30180a0456f9f3aa5a08ebe1cdb","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1.47G/1.47G [00:48&lt;00:00, 30.3MB/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_299748a6b86041ab8dbdddef56b8a1c1"}},"f0265fb7ba1b45f6a9f9187918bf549c":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"d299f05a0190420cbee345284d7018a0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3554e30180a0456f9f3aa5a08ebe1cdb":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"299748a6b86041ab8dbdddef56b8a1c1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"R3gcwjDTd4oY","colab_type":"text"},"source":["<img align=\"right\" width=\"450px\" src=\"https://github.com/digitalepidemiologylab/covid-twitter-bert/raw/master/images/COVID-Twitter-BERT-medium.png\">\n","\n","# Finetuning COVID-Twitter-BERT using Huggingface\n","In this notebook we will finetune CT-BERT for sentiment classification using the transformer library by Huggingface.\n","\n","Learn more about this library [here](https://huggingface.co/transformers/).\n","\n","## Before proceeding\n","Create a copy of this notebook by going to \"File - Save a Copy in Drive\"\n"]},{"cell_type":"markdown","metadata":{"id":"pVsmxmSberX2","colab_type":"text"},"source":["# Install transformers and import libraries"]},{"cell_type":"code","metadata":{"id":"-_k-GwPM9JXP","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":665},"executionInfo":{"status":"ok","timestamp":1600944908826,"user_tz":-330,"elapsed":9179,"user":{"displayName":"Codexter","photoUrl":"","userId":"08428016500949566558"}},"outputId":"e94bbe07-8eb3-4e00-a319-3aa5bfc6cc90"},"source":["!pip install transformers"],"execution_count":1,"outputs":[{"output_type":"stream","text":["Collecting transformers\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/d8/f4/9f93f06dd2c57c7cd7aa515ffbf9fcfd8a084b92285732289f4a5696dd91/transformers-3.2.0-py3-none-any.whl (1.0MB)\n","\u001b[K     |████████████████████████████████| 1.0MB 6.4MB/s \n","\u001b[?25hRequirement already satisfied: requests in /usr/local/lib/python3.6/dist-packages (from transformers) (2.23.0)\n","Collecting sacremoses\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/7d/34/09d19aff26edcc8eb2a01bed8e98f13a1537005d31e95233fd48216eed10/sacremoses-0.0.43.tar.gz (883kB)\n","\u001b[K     |████████████████████████████████| 890kB 31.1MB/s \n","\u001b[?25hRequirement already satisfied: dataclasses; python_version < \"3.7\" in /usr/local/lib/python3.6/dist-packages (from transformers) (0.7)\n","Collecting tokenizers==0.8.1.rc2\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/80/83/8b9fccb9e48eeb575ee19179e2bdde0ee9a1904f97de5f02d19016b8804f/tokenizers-0.8.1rc2-cp36-cp36m-manylinux1_x86_64.whl (3.0MB)\n","\u001b[K     |████████████████████████████████| 3.0MB 40.3MB/s \n","\u001b[?25hRequirement already satisfied: numpy in /usr/local/lib/python3.6/dist-packages (from transformers) (1.18.5)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.6/dist-packages (from transformers) (2019.12.20)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.6/dist-packages (from transformers) (20.4)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.6/dist-packages (from transformers) (4.41.1)\n","Collecting sentencepiece!=0.1.92\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/d4/a4/d0a884c4300004a78cca907a6ff9a5e9fe4f090f5d95ab341c53d28cbc58/sentencepiece-0.1.91-cp36-cp36m-manylinux1_x86_64.whl (1.1MB)\n","\u001b[K     |████████████████████████████████| 1.1MB 38.0MB/s \n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.6/dist-packages (from transformers) (3.0.12)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.6/dist-packages (from requests->transformers) (3.0.4)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.6/dist-packages (from requests->transformers) (2020.6.20)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.6/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.6/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from sacremoses->transformers) (1.15.0)\n","Requirement already satisfied: click in /usr/local/lib/python3.6/dist-packages (from sacremoses->transformers) (7.1.2)\n","Requirement already satisfied: joblib in /usr/local/lib/python3.6/dist-packages (from sacremoses->transformers) (0.16.0)\n","Requirement already satisfied: pyparsing>=2.0.2 in /usr/local/lib/python3.6/dist-packages (from packaging->transformers) (2.4.7)\n","Building wheels for collected packages: sacremoses\n","  Building wheel for sacremoses (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for sacremoses: filename=sacremoses-0.0.43-cp36-none-any.whl size=893257 sha256=fc5fa260cda0b1fe5e5fe104ff75d8f4854190f78978fca551dc9376bd6da581\n","  Stored in directory: /root/.cache/pip/wheels/29/3c/fd/7ce5c3f0666dab31a50123635e6fb5e19ceb42ce38d4e58f45\n","Successfully built sacremoses\n","Installing collected packages: sacremoses, tokenizers, sentencepiece, transformers\n","Successfully installed sacremoses-0.0.43 sentencepiece-0.1.91 tokenizers-0.8.1rc2 transformers-3.2.0\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"jvvPnOFQH2pR","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1600944921166,"user_tz":-330,"elapsed":7420,"user":{"displayName":"Codexter","photoUrl":"","userId":"08428016500949566558"}}},"source":["from transformers import (\n","   AutoConfig,\n","   AutoTokenizer,\n","   TFAutoModelForSequenceClassification,\n","   AdamW,\n","   glue_convert_examples_to_features\n",")\n","import tensorflow as tf\n","import tensorflow_datasets as tfds\n","import json"],"execution_count":2,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"hrDpLTI7Jt5p","colab_type":"text"},"source":["# Choose a Model from the Huggingface Library"]},{"cell_type":"code","metadata":{"id":"tyLIi4bvImJZ","colab_type":"code","cellView":"both","colab":{"base_uri":"https://localhost:8080/","height":118,"referenced_widgets":["a9f62d69afac4080b839a6a407dfa215","53c87125fb0f4ec581d67adfd3d15fb9","e3a171245ce94e9faf8dcb0a38873251","5f3c9cc29cee4f28bbb36fd38ed80962","5d1dd23eeac54f408c32839da1b9683e","7675b01d5184478b8055739853e5541d","e9521088cdc943478bfc312258d2c87c","1b7090e0e809405886f311cac86c66bd","d06c9290289543c3b61dec4c003459c0","8ee24d3b547244369ecc0bb188c4caa6","65406a6ef4814c41b2c200434d93b754","b3ad124c70804452b9b6e998a0f25534","b4ebf1df16164843a9ecb8c49f8fd4da","1e06490637494e2c82bfc75e99f4a655","fe9097ca60394923a73327ba2ae69913","8b26b6f713d4446793dffe5ce6a8352a"]},"executionInfo":{"status":"ok","timestamp":1600944943520,"user_tz":-330,"elapsed":5024,"user":{"displayName":"Codexter","photoUrl":"","userId":"08428016500949566558"}},"outputId":"79f6c057-f4b6-454e-941e-fe5b952b8f71"},"source":["# Choose model\n","# @markdown >The default model is <i><b>COVID-Twitter-BERT</b></i>. You can however choose <i><b>BERT Base</i></b> or <i><b>BERT Large</i></b> to compare these models to the <i><b>COVID-Twitter-BERT</i></b>. All these three models will be initiated with a random classification layer. If you go directly to the Predict-cell after having compiled the model, you will see that it still runs the predition. However the output will be random. The training steps below will finetune this for the specific task. <br /><br /> \n","model_name = 'digitalepidemiologylab/covid-twitter-bert' #@param [\"digitalepidemiologylab/covid-twitter-bert\", \"bert-large-uncased\", \"bert-base-uncased\"]\n","\n","# Initialise tokenizer\n","tokenizer = AutoTokenizer.from_pretrained(model_name)"],"execution_count":3,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a9f62d69afac4080b839a6a407dfa215","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=421.0, style=ProgressStyle(description_…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"d06c9290289543c3b61dec4c003459c0","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=231508.0, style=ProgressStyle(descripti…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"hHV5bBsAw4tl","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":35},"executionInfo":{"status":"ok","timestamp":1600945157944,"user_tz":-330,"elapsed":25119,"user":{"displayName":"Codexter","photoUrl":"","userId":"08428016500949566558"}},"outputId":"24026998-a17c-4958-c260-4b4667dc244c"},"source":["import pandas as pd\n","import numpy as np\n","data_directory = \"drive/My Drive/MTP/data/\"\n","from google.colab import drive\n","drive.mount('/content/drive', force_remount=True)"],"execution_count":4,"outputs":[{"output_type":"stream","text":["Mounted at /content/drive\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"0aRuQa0gxgp7","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":54},"executionInfo":{"status":"ok","timestamp":1600945276362,"user_tz":-330,"elapsed":4135,"user":{"displayName":"Codexter","photoUrl":"","userId":"08428016500949566558"}},"outputId":"c846382b-5d37-4550-b32d-a704715544b9"},"source":["!pip install nltk"],"execution_count":7,"outputs":[{"output_type":"stream","text":["Requirement already satisfied: nltk in /usr/local/lib/python3.6/dist-packages (3.2.5)\n","Requirement already satisfied: six in /usr/local/lib/python3.6/dist-packages (from nltk) (1.15.0)\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"cIAc0id5xTE9","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":54},"executionInfo":{"status":"ok","timestamp":1600945303552,"user_tz":-330,"elapsed":1303,"user":{"displayName":"Codexter","photoUrl":"","userId":"08428016500949566558"}},"outputId":"d1703dde-f270-42f1-f1b7-978b2499fa17"},"source":["import nltk\n","from nltk import word_tokenize\n","from nltk.corpus import stopwords\n","from string import punctuation\n","from scipy.spatial import distance\n","\n","nltk.download('stopwords')\n","stop_words = set(stopwords.words('english'))\n","def preprocess_sentence(text):\n","    text = text.replace('/', ' / ')\n","    text = text.replace('.-', ' .- ')\n","    text = text.replace('.', ' . ')\n","    text = text.replace('\\'', ' \\' ')\n","    text = text.lower()\n","\n","    tokens = [token for token in word_tokenize(text) if token not in punctuation and token not in stop_words]\n","\n","    return ' '.join(tokens)"],"execution_count":8,"outputs":[{"output_type":"stream","text":["[nltk_data] Downloading package stopwords to /root/nltk_data...\n","[nltk_data]   Unzipping corpora/stopwords.zip.\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"mo8K_L-wx5aI","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":72},"executionInfo":{"status":"ok","timestamp":1600945365467,"user_tz":-330,"elapsed":1624,"user":{"displayName":"Codexter","photoUrl":"","userId":"08428016500949566558"}},"outputId":"69729715-ef80-4c2e-ef98-1a796fcbba40"},"source":["nltk.download('punkt')"],"execution_count":10,"outputs":[{"output_type":"stream","text":["[nltk_data] Downloading package punkt to /root/nltk_data...\n","[nltk_data]   Unzipping tokenizers/punkt.zip.\n"],"name":"stdout"},{"output_type":"execute_result","data":{"text/plain":["True"]},"metadata":{"tags":[]},"execution_count":10}]},{"cell_type":"code","metadata":{"id":"a0sUiIPXxG-p","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1600945369806,"user_tz":-330,"elapsed":3090,"user":{"displayName":"Codexter","photoUrl":"","userId":"08428016500949566558"}}},"source":["preprocessed_train_tsv = data_directory + \"preprocessed_train.tsv\"  #remove ‘content/’ from path then use \n","train_data = pd.read_csv(preprocessed_train_tsv, sep='\\t')\n","\n","train_data['Text'] = train_data['Text'].apply(lambda x: \" \".join(preprocess_sentence(x)))\n","    \n","X_train = train_data['Text'].to_numpy()\n","y_train = train_data['Label'].to_numpy()"],"execution_count":11,"outputs":[]},{"cell_type":"code","metadata":{"id":"8gnB12mfxGwG","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1600945390011,"user_tz":-330,"elapsed":1734,"user":{"displayName":"Codexter","photoUrl":"","userId":"08428016500949566558"}}},"source":["validation_tsv = data_directory + \"preprocessed_valid.tsv\"  #remove ‘content/’ from path then use \n","valid_data = pd.read_csv(validation_tsv, sep='\\t')\n","\n","valid_data['Text'] = valid_data['Text'].apply(lambda x: \" \".join(preprocess_sentence(x)))\n","\n","#X_valid = vectorizer.fit_transform(valid_data['Text'].to_numpy())\n","X_valid = valid_data['Text'].to_numpy()\n","y_valid = valid_data['Label'].to_numpy()"],"execution_count":12,"outputs":[]},{"cell_type":"code","metadata":{"id":"7t5gmSQOyBPa","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":109},"executionInfo":{"status":"ok","timestamp":1600945428679,"user_tz":-330,"elapsed":2034,"user":{"displayName":"Codexter","photoUrl":"","userId":"08428016500949566558"}},"outputId":"83c202f7-14a7-4758-b533-8676a01f8d1c"},"source":["data_train = X_train\n","\n","data_test = X_valid\n","\n","print('data loaded')\n","\n","target_names = ['0', '1']\n","\n","def size_mb(docs):\n","    return sum(len(s.encode('utf-8')) for s in docs) / 1e6\n","\n","\n","data_train_size_mb = size_mb(data_train)\n","data_test_size_mb = size_mb(data_test)\n","\n","print(\"%d documents - %0.3fMB (training set)\" % (\n","    len(data_train), data_train_size_mb))\n","print(\"%d documents - %0.3fMB (test set)\" % (\n","    len(data_test), data_test_size_mb))\n","print(\"%d categories\" % len(target_names))\n","print()\n","\n","# split a training set and a test set\n","y_train, y_test = y_train, y_valid"],"execution_count":13,"outputs":[{"output_type":"stream","text":["data loaded\n","6936 documents - 1.907MB (training set)\n","1000 documents - 0.273MB (test set)\n","2 categories\n","\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"k2HRHKV8yKer","colab_type":"code","colab":{}},"source":[""],"execution_count":null,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"GdiZDL69JpNC","colab_type":"text"},"source":["# Download the SST-2 Dataset and Prepare for Finetuning\n","You can skip this step if you are using the already finetuned model"]},{"cell_type":"code","metadata":{"id":"11kI0lhIJoxd","colab_type":"code","cellView":"both","colab":{"base_uri":"https://localhost:8080/","height":756,"referenced_widgets":["6b5dd48483d146f6b84387ded636d1a1","4f23c7b159c74b6eb58632e318a457f8","1cf3af77ea7d477bbf6520d505d7964a","291fea0296f142e0a88247e4d7234f1c","21440d6a9a2247d4a76e204065427f5a","f09f8e1e3e594f218474d572039e113c","583155561188413c8c85c31b4f8f0dfb","c346b17104064b02bb038a17a4a30fd2","134df7bab1a54b8ca72df957a4969fdb","bddc6e27220549d789162106d467e228","8925cfbbf6da49268eb3624dd786457c","bad2dde9b4ae4bcd9354ccdd45fa09e7","5cabcb9b516048648c5b82e8f4076054","6f68a74553324ba9950952347a9d6632","ab77816ed35540e0aed5e953476973de","66040b7f0b8c4dc3be1d212e57558231","8bb2ae80097b4e859e6f941202021a16","6888bc1d4ed249d284ff7c0aeaeebe24","5a3d59d501f44664977bc96f943dd432","e308e7ce897f4f14b475e7c932848a15","fd87d3d07e124b9cb321070e5581cc32","e530d02650d84edeb5395ed828639eb2","55ce2d8c89644d99936d3067719a1b67","e6f17424f81c44a39eb080ac6aaf6c0b","b4c8e28ce61c49f397ba22d401d3367f","e1a683ba136e4e91963ebe731a0d8e8c","6338f93da0254c14a2d9c75107ae0826","978e793156fe4ea2b9184e2179231508","8c36c7821268467abe7d3f32c3a63e47","f7f5fc8c8d0e4ae2a0860cb65bd34e44","002c3449d9784af88ebae617322401bd","7a64d6adad894d58949a82a2451b5a08","8e1e88c3db8546f4976ba22a5a352b6f","5a4005cccb094289aecd8940f7b92982","6991e8054c3f4956b026f21483a057dd","897dffd6859a470fa21e0fe9c05dfede","cd927323519d45528f8bbabc7bbea025","6cfea569105d4ae08be5d561b738957a","b6f1f4362b424b4e899907122ebb6605","462e909ed6d24fa4b4fdb9ba31948c62","0d2408609b59439abfa3a45ec762d981","c82597d869d246a683cfba632ca84190","8ca7442e125c4662933cf169c96447f8","2e03efa720ed4ec7bd6ec710ea1854be","44c633f9229f48f283fb2145a100a5d9","762bf18427954f9a9a6b447bb01b151d","894b0fff28b742189c8ea6906e8ce857","ed9da6d94fe342b9b56903d73bf47844","1c2a1f72361c407d89c3310e5b995f29","7116cbc123a944eabd974044fb65524f","8ba5ba2b586847589845cee62a06e233","97875d64ee5d4f6f971d17516bf27aa8","d45ebbf8c5f84d66bdd39af9390092a5","366448a3f8cf40f794705ffa80cb24ec","30b09c9f17e4485f9453fec50be827ea","8a9f5e4fbc1947d8a7017e4b98e9eefa","323a661cbdd54394a7ca629240a5879e","565daf2757a84ddfba99ba2d22d67701","8c28a2c70a79477b84d05b4af8ce1678","c7bddcb5383145d8af92f9d3f39b9d02","ca973546fc2242e8acc22e721df0e837","3037a765ecf94c54adae0f0ea3910810","eebc3cba722c4dac8ef1b72682d04522","fcf15b8a10e9464899c3daafe9cb7174","3d816b28359e48a6b429f5a91e50109d","96e2061317034719b31fb4e474e49233","fc030b73ced7487b831064fe2d030ea9","da727efa21c04bd9aadb64e5212de8c4","5e8c00e558594d87a295655d77d882a3","ad44a023ca1c4b1cb31a70551ab9926f","25b53a4457e241f899c67dd3cc27767f","f016305661d94573b22509bd44c299f9"]},"outputId":"adb596a5-6cb0-4f42-b62e-95388207ee4c"},"source":["# Paramteters\n","#@markdown >Batch size and sequence length needs to be set to prepare the data. The size of the batches depends on available memory. For Colab GPU limit batch size to 8 and sequence length to 96. By reducing the length of the input (max_seq_length) you can also increase the batch size. For a dataset like SST-2 with lots of short sentences. this will likely benefit training.\n","max_seq_length = 96 #@param {type: \"integer\"}\n","train_batch_size =  8#@param {type: \"integer\"} \n","eval_batch_size = 8 #@param {type: \"integer\"}\n","\n","\n","#@markdown >The Glue dataset has around 62000 examples, and we really do not need them all for training a decent model. To cut down training time, please reduse this to only a percentage of the entire set.\n","use_percentage_of_data = 5 #@param {type: \"slider\", min: 1, max: 100}\n","\n","# get dataset sizes\n","glue_builder = tfds.builder('glue/sst2')\n","num_train_examples = glue_builder.info.splits['train'].num_examples\n","num_dev_examples = glue_builder.info.splits['validation'].num_examples\n","num_labels = glue_builder.info.features['label'].num_classes\n","'''\n","glue_builder = tfds.builder('glue/sst2')\n","num_train_examples = glue_builder.info.splits['train'].num_examples\n","num_dev_examples = glue_builder.info.splits['validation'].num_examples\n","num_labels = glue_builder.info.features['label'].num_classes\n","'''\n","\n","# download datasets and convert to training features\n","glue_builder.download_and_prepare()\n","train_data = glue_builder.as_dataset(split='train')\n","train_dataset = glue_convert_examples_to_features(train_data, tokenizer, max_length=max_seq_length, task='sst-2')\n","train_dataset = train_dataset.shuffle(100).batch(train_batch_size)\n","\n","dev_data = glue_builder.as_dataset(split='validation')\n","dev_dataset = glue_convert_examples_to_features(dev_data, tokenizer, max_length=max_seq_length, task='sst-2')\n","dev_dataset = dev_dataset.shuffle(100).batch(eval_batch_size)\n","\n","# Map the labels for printing\n","label_mapping = {i: glue_builder.info.features['label'].int2str(i) for i in range(num_labels)}\n","\n","print(f'\\n\\nThe dataset is downloaded. The entire dataset has {num_train_examples + num_dev_examples} examples of which you are using {use_percentage_of_data}%. This will result in a train dataset with {int(num_train_examples * (use_percentage_of_data/100))} examples and a validation dataset with {int(num_dev_examples * (use_percentage_of_data/100))} examples.')"],"execution_count":null,"outputs":[{"output_type":"stream","text":["INFO:absl:Load pre-computed datasetinfo (eg: splits) from bucket.\n","INFO:absl:Loading info from GCS for glue/sst2/1.0.0\n","INFO:absl:Field info.description from disk and from code do not match. Keeping the one from code.\n","INFO:absl:Field info.location from disk and from code do not match. Keeping the one from code.\n","INFO:absl:Generating dataset glue (/root/tensorflow_datasets/glue/sst2/1.0.0)\n"],"name":"stderr"},{"output_type":"stream","text":["\u001b[1mDownloading and preparing dataset glue/sst2/1.0.0 (download: 7.09 MiB, generated: Unknown size, total: 7.09 MiB) to /root/tensorflow_datasets/glue/sst2/1.0.0...\u001b[0m\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"6b5dd48483d146f6b84387ded636d1a1","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Dl Completed...', max=1.0, style=Progre…"]},"metadata":{"tags":[]}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"134df7bab1a54b8ca72df957a4969fdb","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Dl Size...', max=1.0, style=ProgressSty…"]},"metadata":{"tags":[]}},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"8bb2ae80097b4e859e6f941202021a16","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', description='Extraction completed...', max=1.0, styl…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["INFO:absl:Downloading https://firebasestorage.googleapis.com/v0/b/mtl-sentence-representations.appspot.com/o/data%2FSST-2.zip?alt=media&token=aabc5f6b-e466-44a2-b9b4-cf6337f84ac8 into /root/tensorflow_datasets/downloads/fire.goog.com_v0_b_mtl-sent-repr.apps.cowOhVrpNUsvqdZqI70Nq3ISu63l9SOhTqYqoz6uEW3-Y.zipalt=media&token=aabc5f6b-e466-44a2-b9b4-cf6337f84ac8.tmp.5a488d8d16ea46da83cef961a62e14e4...\n","/usr/local/lib/python3.6/dist-packages/urllib3/connectionpool.py:847: InsecureRequestWarning: Unverified HTTPS request is being made. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings\n","  InsecureRequestWarning)\n","INFO:absl:Generating split train\n"],"name":"stderr"},{"output_type":"stream","text":["\n","\n","\n","\n","\n","\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"b4c8e28ce61c49f397ba22d401d3367f","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\rShuffling and writing examples to /root/tensorflow_datasets/glue/sst2/1.0.0.incomplete9F37IY/glue-train.tfrecord\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"8e1e88c3db8546f4976ba22a5a352b6f","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=67349.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["INFO:absl:Done writing /root/tensorflow_datasets/glue/sst2/1.0.0.incomplete9F37IY/glue-train.tfrecord. Shard lengths: [67349]\n","INFO:absl:Generating split validation\n"],"name":"stderr"},{"output_type":"stream","text":["\r"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"0d2408609b59439abfa3a45ec762d981","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\rShuffling and writing examples to /root/tensorflow_datasets/glue/sst2/1.0.0.incomplete9F37IY/glue-validation.tfrecord\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"1c2a1f72361c407d89c3310e5b995f29","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=872.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["INFO:absl:Done writing /root/tensorflow_datasets/glue/sst2/1.0.0.incomplete9F37IY/glue-validation.tfrecord. Shard lengths: [872]\n","INFO:absl:Generating split test\n"],"name":"stderr"},{"output_type":"stream","text":["\r"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"323a661cbdd54394a7ca629240a5879e","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\rShuffling and writing examples to /root/tensorflow_datasets/glue/sst2/1.0.0.incomplete9F37IY/glue-test.tfrecord\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"3d816b28359e48a6b429f5a91e50109d","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, max=1821.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["INFO:absl:Done writing /root/tensorflow_datasets/glue/sst2/1.0.0.incomplete9F37IY/glue-test.tfrecord. Shard lengths: [1821]\n","INFO:absl:Skipping computing stats for mode ComputeStatsMode.AUTO.\n","INFO:absl:Constructing tf.data.Dataset for split train, from /root/tensorflow_datasets/glue/sst2/1.0.0\n"],"name":"stderr"},{"output_type":"stream","text":["\u001b[1mDataset glue downloaded and prepared to /root/tensorflow_datasets/glue/sst2/1.0.0. Subsequent calls will reuse this data.\u001b[0m\n","\r"],"name":"stdout"},{"output_type":"stream","text":["INFO:absl:Constructing tf.data.Dataset for split validation, from /root/tensorflow_datasets/glue/sst2/1.0.0\n"],"name":"stderr"},{"output_type":"stream","text":["\n","\n","The dataset is downloaded. The entire dataset has 68221 examples of which you are using 5%. This will result in a train dataset with 3367 examples and a validation dataset with 43 examples.\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"K2AsubSgKGDu","colab_type":"text"},"source":["# Compile the Model, Train it on the SST-2 Task and Save the Result\n","You can skip this step if you are using the already finetuned model"]},{"cell_type":"code","metadata":{"id":"2XSbsZFDQTEO","colab_type":"code","cellView":"both","colab":{"base_uri":"https://localhost:8080/","height":695,"referenced_widgets":["448f914b46b644f5851f1af379b6a4e1","0b613b02dfe34bb682b4964c15808aff","fe8a58e6570b47368d8af58c9f88252d","def365577baa4c06964afa044aeaf6c2","f0265fb7ba1b45f6a9f9187918bf549c","d299f05a0190420cbee345284d7018a0","3554e30180a0456f9f3aa5a08ebe1cdb","299748a6b86041ab8dbdddef56b8a1c1"]},"outputId":"2596ac65-32e7-4a2e-ef9b-5aaf2689d969"},"source":["#@markdown >The default learning rate of 2e5 will be fine in most cases\n","learning_rate = 2e-5 #@param {type: \"number\"}\n","\n","#@markdown > Typically these type of models are finetuned for 3 epochs. This can be increased for small datasets and decreased for large datasets.\n","num_epochs = 1  #@param {type: \"integer\"}\n","\n","# Initialise a Model for Sequence Classification with 2 labels\n","config = AutoConfig.from_pretrained(model_name, num_labels=num_labels)\n","model = TFAutoModelForSequenceClassification.from_pretrained(model_name, config=config)\n","\n","# Optimizer and loss\n","optimizer = tf.keras.optimizers.Adam(learning_rate=learning_rate)\n","loss = tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True)\n","\n","# Metrics and callbacks\n","metrics = [tf.keras.metrics.SparseCategoricalAccuracy('accuracy', dtype=tf.float32)]\n","checkpoint_path = './checkpoints/checkpoint.{epoch:02d}'\n","callbacks = [tf.keras.callbacks.ModelCheckpoint(checkpoint_path, save_weights_only=True)]\n","\n","# Compute some variables\n","train_steps_per_epoch = int(num_train_examples * (use_percentage_of_data/100) / train_batch_size)\n","dev_steps_per_epoch = int(num_dev_examples * (use_percentage_of_data/100) / eval_batch_size)\n","\n","\n","# Compile model\n","model.compile(optimizer=optimizer, loss=loss, metrics=metrics)\n","\n","# Train the model\n","history = model.fit(train_dataset, \n","  epochs=num_epochs,\n","  steps_per_epoch=train_steps_per_epoch,\n","  validation_data=dev_dataset,\n","  validation_steps=dev_steps_per_epoch,\n","  callbacks=callbacks)\n","\n","# Print some information about the training\n","print(f'\\nThe training has finished training after {num_epochs} epochs.')\n","print('\\nThe history contains the accuracy and loss at every epoch:')\n","print(json.dumps(history.history, indent=4))\n","\n","print('\\nThe checkpoint callback has generated a checkpoint after every epoch (loss being the training loss, val_loss is the validation loss):')\n","!ls -lha ./checkpoints/\n","\n","print('\\nWe will now save the finetuned model and the corresponding config file on your Colab disk.')\n","model.save_pretrained('./huggingface_model/')\n","\n","print('\\nTensorflow model and config-file is saved in ./huggingface_model/')\n","!ls -lha ./huggingface_model/"],"execution_count":null,"outputs":[{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"448f914b46b644f5851f1af379b6a4e1","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=0.0, description='Downloading', max=1472566816.0, style=ProgressStyle(descr…"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["\n"],"name":"stdout"},{"output_type":"stream","text":["WARNING:transformers.modeling_tf_utils:Some weights of the model checkpoint at digitalepidemiologylab/covid-twitter-bert were not used when initializing TFBertForSequenceClassification: ['nsp___cls', 'mlm___cls']\n","- This IS expected if you are initializing TFBertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPretraining model).\n","- This IS NOT expected if you are initializing TFBertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).\n","WARNING:transformers.modeling_tf_utils:Some weights of TFBertForSequenceClassification were not initialized from the model checkpoint at digitalepidemiologylab/covid-twitter-bert and are newly initialized: ['dropout_73', 'classifier']\n","You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.\n"],"name":"stderr"},{"output_type":"stream","text":["420/420 [==============================] - 228s 542ms/step - loss: 0.3885 - accuracy: 0.8313 - val_loss: 0.2758 - val_accuracy: 0.9000\n","\n","The training has finished training after 1 epochs.\n","\n","The history contains the accuracy and loss at every epoch:\n","{\n","    \"loss\": [\n","        0.38849541544914246\n","    ],\n","    \"accuracy\": [\n","        0.831250011920929\n","    ],\n","    \"val_loss\": [\n","        0.2758089601993561\n","    ],\n","    \"val_accuracy\": [\n","        0.8999999761581421\n","    ]\n","}\n","\n","The checkpoint callback have generated a checkpoint after every epoch:\n","total 3.8G\n","drwxr-xr-x 2 root root 4.0K Jul 17 19:01 .\n","drwxr-xr-x 1 root root 4.0K Jul 17 19:00 ..\n","-rw-r--r-- 1 root root   83 Jul 17 19:01 checkpoint\n","-rw-r--r-- 1 root root 6.3M Jul 17 19:00 checkpoint.01.data-00000-of-00002\n","-rw-r--r-- 1 root root 3.8G Jul 17 19:01 checkpoint.01.data-00001-of-00002\n","-rw-r--r-- 1 root root  87K Jul 17 19:01 checkpoint.01.index\n","\n","We will now save the finetuned model and the corresponding config file on your Colab disk.\n","\n","Tensorflow model and config-file is saved in ./tfmodel/\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"qYamwzWeM9vM","colab_type":"text"},"source":["# Predict\n","Let's run some inference with the trained model"]},{"cell_type":"code","metadata":{"id":"0T0zy0fK9Rmx","colab_type":"code","colab":{}},"source":["# Small function only used for formatting the output\n","def format_prediction(preds, label_mapping, label_name):\n","    preds = tf.nn.softmax(preds, axis=1)\n","    formatted_preds = []\n","    for pred in preds.numpy():\n","        # convert to Python types and sort\n","        pred = {label: float(probability) for label, probability in zip(label_mapping.values(), pred)}\n","        pred = {k: v for k, v in sorted(pred.items(), key=lambda item: item[1], reverse=True)}\n","        formatted_preds.append({label_name: list(pred.keys())[0], f'{label_name}_probabilities': pred})\n","    return formatted_preds"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"Rdk8zasnKJWj","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":306},"outputId":"2bd94685-beff-494b-b389-94d600844ad3"},"source":["#@markdown >Please input text that the model can try to classify\n","input_text = 'Happy little clouds'  #@param {type: \"string\"}\n","\n","# Tokenize the input \n","input_ids = tf.constant(tokenizer.encode(input_text, add_special_tokens=True))[None, :]\n","\n","# Run predictions\n","preds = model(input_ids)\n","\n","# format logits\n","formatted_preds = format_prediction(preds[0], label_mapping, 'sentiment')\n","\n","print(f'\\nLabel Mapping:{json.dumps(label_mapping, indent=4)}')\n","print(f'\\nLogits: {preds}')\n","print(f'\\nProbabilities:{json.dumps(formatted_preds, indent=4)}')"],"execution_count":null,"outputs":[{"output_type":"stream","text":["\n","Label Mapping:{\n","    \"0\": \"negative\",\n","    \"1\": \"positive\"\n","}\n","\n","Logits: (<tf.Tensor: shape=(1, 2), dtype=float32, numpy=array([[-0.9338014,  0.8854352]], dtype=float32)>,)\n","\n","Probabilities:[\n","    {\n","        \"sentiment\": \"positive\",\n","        \"sentiment_probabilities\": {\n","            \"positive\": 0.8604745268821716,\n","            \"negative\": 0.13952548801898956\n","        }\n","    }\n","]\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"WBq1C2U9ScWg","colab_type":"text"},"source":["##### Copyright 2020 Per Egil Kummervold and Martin Müller"]}]}